# 移动端派工系统需求梳理

## 项目概述

### 系统架构
- **前端**: 移动端（手机端）
- **后端**: Web端（电脑端）
- **开发语言**: Java
- **数据库**: MySQL
- **通信协议**: TCP/IP（与PLC通信）

### 登录信息
- **默认用户名**: admin
- **默认密码**: 123456

## 手机端功能需求

### 界面设计要求
- **设计风格**: 工业风格
- **主界面**: 5个功能模块，每个模块需要图标
- **交互方式**: 卡片式选择

### 功能模块详细需求

#### 1. 设备派工
**输入字段**:
- 派工单号（手动输入）
- 预计生产数量（手动输入）
- 生产设备型号（下拉选择：CNC、CCM08、CCM32）
- 设备编号（根据设备型号动态显示）
  - CNC: CNC-01 ~ CNC-16
  - CCM08: CCM08-01 ~ CCM08-24
  - CCM23: CCM23-01 ~ CCM23-06
  - AOI: AOI-01 ~ AOI-02

**业务流程**:
1. 用户填写派工信息
2. 点击"开始生产"按钮
3. 弹窗确认派工信息
4. 用户确认后执行PLC通信
5. PLC通信流程：
   - 连接PLC（使用功能5设定的IP）
   - 对选择设备的清零点位写入1
   - 等待1秒
   - 查询对应数据点位是否为0
   - 最多查询3次，如不为0则提示设备或网络问题
   - 如为0则继续执行
6. 将派工信息写入数据库
7. 提示"已安排生产"
8. 清空填写数据

**数据存储**:
- 派工单号
- 设备编号
- 预计生产数量
- 生产开始时间

#### 2. 设备停止生产
**显示信息**:
- 设备编号
- 派工单号
- 预计生产数量
- 目前已生产数量
- 生产启动时间
- 完成比例（当前数量/预计数量）

**交互方式**:
- 卡片式展示正在生产的设备
- 选择要停止的派工单
- 确认弹窗显示派工单号和设备编号

**数据记录**:
- 派工单号
- 设备编号
- 开始生产时间
- 结束生产时间
- 预计生产数量
- 实际完成数量

#### 3. 设备状态查询
**设备清单**:
- AOI: 2台（AOI-01, AOI-02）
- CNC: 16台（CNC-01 ~ CNC-16）
- CCM08: 24台（CCM08-01 ~ CCM08-24）
- CCM23: 6台（CCM23-01 ~ CCM23-06）
- **总计**: 48台设备

**状态类型**:
- 有生产（绑定派工单号）
- 闲置
- 维修中

#### 4. 设备报修
**功能要求**:
- 可对48台设备进行报修操作
- 报修后的设备在派工时不可选择
- 选择维修中设备时提示"维修中"
- 可标记设备为"已修复"
- 已修复设备可重新安排生产

#### 5. PLC IP设定
**功能要求**:
- 设定PLC IP地址
- 保存IP配置
- 后续TCP通信使用保存的IP

## 后台功能需求

### 1. 角色管理
**功能要求**:
- 新增用户
- 配置账号密码
- 用户权限管理

### 2. 生产记录查询
**查询条件**:
- 时间范围
- 派工单号
- 设备编号
- 设备类型

**查询结果**:
- 历史派工记录
- 生产结束记录
- 生产统计信息

### 3. 报表管理
**统计维度**:
- 按月统计
- 按设备统计
- 按时间段统计

**统计内容**:
- 各设备生产数量
- 生产效率
- 设备利用率
- 故障统计

## PLC通信点位映射

### 设备清零点位
根据提供的设备清单，需要定义每个设备对应的PLC点位：

**AOI设备**:
- AOI-01: D1002
- AOI-02: D1004

**CNC设备**:
- CNC-01: D1066
- CNC-02: D1068
- CNC-03: D1070
- CNC-04: D1072
- CNC-05: D1074
- CNC-06: D1076
- CNC-07: D1078
- CNC-08: D1080
- CNC-09: D1082
- CNC-10: D1084
- CNC-11: D1086
- CNC-12: D1088
- CNC-13: D1090
- CNC-14: D1092
- CNC-15: D1094
- CNC-16: D1096

**CCM08设备**:
- CCM08-01: D1006
- CCM08-02: D1008
- CCM08-03: D1010
- CCM08-04: D1012
- CCM08-05: D1014
- CCM08-06: D1016
- CCM08-07: D1018
- CCM08-08: D1020
- CCM08-09: D1022
- CCM08-10: D1024
- CCM08-11: D1026
- CCM08-12: D1028
- CCM08-13: D1030
- CCM08-14: D1032
- CCM08-15: D1034
- CCM08-16: D1036
- CCM08-17: D1038
- CCM08-18: D1040
- CCM08-19: D1042
- CCM08-20: D1044
- CCM08-21: D1046
- CCM08-22: D1048
- CCM08-23: D1050
- CCM08-24: D1052

**CCM23设备**:
- CCM23-01: D1054
- CCM23-02: D1056
- CCM23-03: D1058
- CCM23-04: D1060
- CCM23-05: D1062
- CCM23-06: D1064

## 技术要求

### 开发环境
- Java版本：使用现有系统版本
- MySQL版本：使用现有系统版本
- 不重复安装其他依赖

### 数据一致性
- 与现有PLC数据采集系统保持兼容
- 使用相同的设备编号规范
- 共享PLC通信配置

### 安全要求
- 用户认证
- 操作日志记录
- 数据备份机制

## 项目交付物

### 文档交付
1. 设计文档
2. 数据库设计文档
3. API接口文档
4. 操作手册
5. 业务流程图
6. 环境配置文档

### 代码交付
1. 移动端应用代码
2. 后端服务代码
3. 数据库脚本
4. 配置文件

### 部署交付
1. 安装包
2. 部署脚本
3. 配置说明
4. 测试用例