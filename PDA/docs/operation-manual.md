# 移动端派工系统操作手册

## 手册概述

本操作手册详细介绍移动端派工系统的使用方法，包括手机端应用和后台Web管理系统的完整操作流程。本手册适用于生产操作员、设备维修人员、生产管理员等不同角色的用户。

## 系统环境要求

### 手机端要求
- **操作系统**: Android 6.0+ 或 iOS 10.0+
- **内存**: 至少2GB RAM
- **存储空间**: 至少100MB可用空间
- **网络**: 支持WiFi或4G网络连接
- **屏幕**: 建议5英寸以上屏幕

### 后台Web要求
- **浏览器**: Chrome 70+、Firefox 65+、Safari 12+、Edge 79+
- **分辨率**: 建议1366×768以上
- **网络**: 稳定的局域网或互联网连接

## 第一部分：手机端操作指南

### 1. 系统登录

#### 1.1 首次登录
1. **打开应用**: 点击手机桌面上的"派工系统"图标
2. **输入账号**: 在用户名框中输入"admin"
3. **输入密码**: 在密码框中输入"123456"
4. **点击登录**: 点击"登录"按钮进入系统
5. **首次设置**: 首次登录后建议立即修改密码

#### 1.2 登录异常处理
- **用户名或密码错误**: 检查输入是否正确，注意大小写
- **网络连接失败**: 检查手机网络连接状态
- **服务器无响应**: 联系系统管理员检查服务器状态

### 2. 主界面导航

#### 2.1 主界面布局
登录成功后进入主界面，界面采用工业风格设计，包含以下5个功能模块：

```
┌─────────────────────────────────┐
│        移动端派工系统           │
├─────────────────────────────────┤
│  [🔧] 设备派工    [⏹️] 设备停止生产 │
│                                 │
│  [🔧] 设备报修    [📊] 设备状态查询 │
│                                 │
│        [⚙️] PLC IP设定          │
├─────────────────────────────────┤
│     当前用户: admin             │
│     登录时间: 2024-01-15 08:30  │
└─────────────────────────────────┘
```

#### 2.2 功能模块说明
- **设备派工**: 为设备安排生产任务
- **设备停止生产**: 停止正在进行的生产任务
- **设备报修**: 报告设备故障并申请维修
- **设备状态查询**: 查看所有设备的当前状态
- **PLC IP设定**: 配置PLC通信参数

### 3. 设备派工操作

#### 3.1 操作步骤

**步骤1: 进入派工界面**
1. 在主界面点击"设备派工"图标
2. 进入派工信息录入界面

**步骤2: 选择设备类型**
1. 点击"设备类型"下拉框
2. 从以下选项中选择：
   - CNC（数控机床）
   - CCM08（CCM08设备）
   - CCM32（CCM32设备）

**步骤3: 选择具体设备**
1. 设备类型选择后，"设备编号"下拉框自动更新
2. 根据选择的设备类型，可选择的设备编号：
   - **CNC**: CNC01 ~ CNC16（共16台）
   - **CCM08**: CCM08-01 ~ CCM08-24（共24台）
   - **CCM32**: CCM32-01 ~ CCM32-06（共6台）
3. 选择可用的设备编号（维修中的设备会显示为灰色不可选）

**步骤4: 填写派工信息**
1. **派工单号**: 手动输入派工单号（格式建议：WO + 日期 + 序号，如WO20240115001）
2. **预计生产数量**: 输入计划生产的产品数量（必须为正整数）
3. **备注信息**: 可选择添加备注信息

**步骤5: 确认派工**
1. 点击"开始生产"按钮
2. 系统弹出确认对话框，显示：
   ```
   ┌─────────────────────────┐
   │      确认派工信息       │
   ├─────────────────────────┤
   │ 派工单号: WO20240115001 │
   │ 设备编号: CNC01         │
   │ 预计数量: 1000          │
   │ 操作员: admin           │
   ├─────────────────────────┤
   │   [确认]     [取消]     │
   └─────────────────────────┘
   ```
3. 确认信息无误后点击"确认"按钮

**步骤6: PLC通信验证**
1. 系统显示"正在连接PLC..."提示
2. 系统执行以下操作：
   - 连接到配置的PLC IP地址
   - 向设备对应的清零点位写入1
   - 等待1秒后读取数据点位
   - 验证数据点位是否为0
3. 验证结果处理：
   - **成功**: 显示"PLC通信成功，派工完成"
   - **失败**: 显示"设备或网络有问题，请检查"，派工失败

**步骤7: 完成派工**
1. PLC验证成功后，系统自动：
   - 保存派工记录到数据库
   - 更新设备状态为"运行中"
   - 记录操作日志
2. 显示"已安排生产"成功提示
3. 清空所有输入字段，准备下次操作

#### 3.2 PLC点位对照表

根据设备类型，对应的PLC点位如下：

| 设备编号 | 清零点位 | 数据点位 |
|----------|----------|----------|
| AOI-01   | D1002    | D802     |
| AOI-02   | D1004    | D804     |
| CNC-01   | D1066    | D866     |
| CNC-02   | D1068    | D868     |
| ...      | ...      | ...      |
| CCM08-01 | D1006    | D806     |
| CCM08-02 | D1008    | D808     |
| ...      | ...      | ...      |
| CCM23-01 | D1054    | D854     |
| CCM23-02 | D1056    | D856     |
| ...      | ...      | ...      |

#### 3.3 常见问题处理

**问题1: 派工单号重复**
- **现象**: 提示"派工单号已存在"
- **解决**: 修改派工单号，确保唯一性

**问题2: 设备不可选择**
- **现象**: 设备显示为灰色不可选
- **原因**: 设备正在维修中或已有派工任务
- **解决**: 选择其他可用设备或等待设备可用

**问题3: PLC通信失败**
- **现象**: 提示"设备或网络有问题，请检查"
- **可能原因**:
  - PLC IP地址配置错误
  - 网络连接异常
  - PLC设备故障
  - 设备点位配置错误
- **解决步骤**:
  1. 检查网络连接状态
  2. 确认PLC IP设置是否正确
  3. 联系设备维修人员检查PLC状态
  4. 重试派工操作

### 4. 设备停止生产操作

#### 4.1 操作步骤

**步骤1: 进入停止生产界面**
1. 在主界面点击"设备停止生产"图标
2. 系统自动加载当前正在生产的派工单列表

**步骤2: 查看生产状态**
界面以卡片形式显示所有正在生产的派工单：

```
┌─────────────────────────────────┐
│ 派工单号: WO20240115001         │
│ 设备编号: CNC01                 │
│ 预计数量: 1000                  │
│ 已生产量: 750                   │
│ 开始时间: 2024-01-15 09:00      │
│ 完成比例: ████████░░ 75%        │
│ 运行时长: 2小时30分钟           │
│           [停止生产]            │
└─────────────────────────────────┘
```

**步骤3: 选择要停止的派工单**
1. 浏览所有正在生产的派工单卡片
2. 找到需要停止的派工单
3. 点击对应卡片上的"停止生产"按钮

**步骤4: 确认停止操作**
1. 系统弹出确认对话框：
   ```
   ┌─────────────────────────┐
   │      确认停止生产       │
   ├─────────────────────────┤
   │ 派工单号: WO20240115001 │
   │ 设备编号: CNC01         │
   │ 当前进度: 750/1000      │
   │ 完成比例: 75%           │
   ├─────────────────────────┤
   │   [确认]     [取消]     │
   └─────────────────────────┘
   ```
2. 确认无误后点击"确认"按钮

**步骤5: 输入实际产量（可选）**
1. 系统可能弹出实际产量输入框
2. 如果PLC数据准确，可直接点击"确认"
3. 如需修正，输入实际完成数量后点击"确认"

**步骤6: 完成停止操作**
1. 系统自动执行：
   - 更新派工单状态为"已完成"
   - 记录结束时间和实际产量
   - 更新设备状态为"空闲"
   - 生成生产记录
2. 显示"生产已停止"成功提示
3. 返回停止生产界面，卡片列表自动更新

#### 4.2 数据说明

- **已生产量**: 从PLC实时读取或手动录入
- **完成比例**: 已生产量 ÷ 预计数量 × 100%
- **运行时长**: 当前时间 - 开始生产时间
- **生产效率**: 已生产量 ÷ 运行时长（件/小时）

#### 4.3 注意事项

1. **数据准确性**: 停止生产前确认实际产量的准确性
2. **及时停止**: 生产完成后应及时停止，避免数据统计错误
3. **异常处理**: 如遇设备故障，应先报修再停止生产

### 5. 设备报修操作

#### 5.1 操作步骤

**步骤1: 进入设备报修界面**
1. 在主界面点击"设备报修"图标
2. 进入设备选择界面

**步骤2: 选择要报修的设备**
1. 界面按设备类型分组显示所有48台设备：
   ```
   AOI设备 (2台)
   ├─ AOI-01 [空闲] ✅
   └─ AOI-02 [运行中] ⚠️
   
   CNC设备 (16台)
   ├─ CNC-01 [空闲] ✅
   ├─ CNC-02 [维修中] 🔧
   └─ ...
   
   CCM08设备 (24台)
   └─ ...
   
   CCM23设备 (6台)
   └─ ...
   ```
2. 点击需要报修的设备

**步骤3: 填写故障信息**
1. **故障描述**: 详细描述设备故障现象
   - 例如："设备运行时出现异常噪音，疑似轴承问题"
2. **维修类型**: 选择维修类型
   - **预防性维修**: 定期保养、预防性检查
   - **纠正性维修**: 故障修复、部件更换
   - **紧急维修**: 影响生产的紧急故障
3. **优先级**: 选择维修优先级
   - **低**: 不影响生产，可延后处理
   - **中**: 一般故障，正常排期处理
   - **高**: 影响生产效率，优先处理
   - **紧急**: 严重故障，立即处理
4. **故障时间**: 选择故障发生的时间（默认当前时间）
5. **联系人**: 输入报修人联系方式

**步骤4: 提交报修申请**
1. 检查填写信息的完整性和准确性
2. 点击"提交报修"按钮
3. 系统弹出确认对话框显示报修信息
4. 确认无误后点击"确认提交"

**步骤5: 报修完成**
1. 系统自动：
   - 生成维修单号（格式：MR + 日期 + 序号）
   - 更新设备状态为"维修中"
   - 发送通知给维修人员
   - 记录报修日志
2. 显示维修单号和预计处理时间
3. 设备在维修期间无法安排生产

#### 5.2 维修状态跟踪

**查看维修进度**
1. 在设备状态查询中可查看维修进度
2. 维修状态包括：
   - **已报修**: 维修申请已提交
   - **维修中**: 维修人员正在处理
   - **待验收**: 维修完成，等待验收
   - **已完成**: 维修完成，设备可用

**标记设备已修复**
1. 维修完成后，可在设备报修界面找到对应设备
2. 点击"标记已修复"按钮
3. 填写维修结果和验收信息
4. 确认后设备状态恢复为"空闲"，可重新安排生产

#### 5.3 报修注意事项

1. **详细描述**: 故障描述要详细准确，便于维修人员快速定位问题
2. **优先级设置**: 根据实际影响程度合理设置优先级
3. **及时报修**: 发现设备异常应及时报修，避免故障扩大
4. **安全第一**: 如遇安全隐患，应立即停止使用并紧急报修

### 6. 设备状态查询操作

#### 6.1 操作步骤

**步骤1: 进入状态查询界面**
1. 在主界面点击"设备状态查询"图标
2. 系统自动加载所有设备的当前状态

**步骤2: 查看设备状态**
界面显示所有48台设备的状态信息：

```
┌─── 设备状态总览 ───┐
│ 总设备: 48台       │
│ 运行中: 12台       │
│ 空闲: 30台         │
│ 维修中: 4台        │
│ 故障: 2台          │
└───────────────────┘

设备列表:
┌─────────────────────────────────┐
│ AOI-01 [空闲] 🟢               │
│ 最后使用: 2024-01-15 14:30      │
│ 累计运行: 156小时               │
├─────────────────────────────────┤
│ CNC-01 [运行中] 🔵             │
│ 派工单号: WO20240115001         │
│ 进度: 750/1000 (75%)           │
│ 运行时长: 2小时30分钟           │
├─────────────────────────────────┤
│ CCM08-01 [维修中] 🔧           │
│ 维修单号: MR20240115001         │
│ 故障描述: 轴承异响              │
│ 预计完成: 2024-01-16 10:00      │
└─────────────────────────────────┘
```

**步骤3: 使用筛选功能**
1. **按状态筛选**:
   - 点击"状态筛选"按钮
   - 选择要查看的状态：全部/运行中/空闲/维修中/故障
2. **按设备类型筛选**:
   - 选择设备类型：全部/AOI/CNC/CCM08/CCM23
3. **搜索功能**:
   - 在搜索框输入设备编号或名称进行搜索

**步骤4: 查看设备详情**
1. 点击任意设备卡片
2. 进入设备详情界面，显示：
   - 设备基本信息
   - 当前状态详情
   - 历史派工记录
   - 维修历史记录
   - 性能统计数据

#### 6.2 状态说明

| 状态图标 | 状态名称 | 说明 |
|----------|----------|------|
| 🟢 | 空闲 | 设备可用，可安排生产 |
| 🔵 | 运行中 | 设备正在生产，显示当前派工信息 |
| 🔧 | 维修中 | 设备正在维修，无法安排生产 |
| 🔴 | 故障 | 设备故障，需要维修 |
| ⚠️ | 异常 | 设备状态异常，需要检查 |

#### 6.3 实时更新

1. **自动刷新**: 界面每30秒自动刷新设备状态
2. **手动刷新**: 下拉界面可手动触发刷新
3. **状态推送**: 设备状态变化时会实时推送更新

### 7. PLC IP设定操作

#### 7.1 操作步骤

**步骤1: 进入IP设定界面**
1. 在主界面点击"PLC IP设定"图标
2. 进入PLC配置界面

**步骤2: 查看当前配置**
界面显示当前的PLC配置信息：
```
┌─── PLC通信配置 ───┐
│ IP地址: 192.168.1.100 │
│ 端口: 502             │
│ 超时时间: 5秒         │
│ 重试次数: 3次         │
│ 连接状态: 已连接 🟢   │
└─────────────────────┘
```

**步骤3: 修改配置**
1. **IP地址**: 输入新的PLC IP地址
   - 格式：xxx.xxx.xxx.xxx
   - 例如：192.168.1.100
2. **端口号**: 修改通信端口（默认502）
3. **超时时间**: 设置连接超时时间（1-30秒）
4. **重试次数**: 设置通信失败重试次数（1-5次）

**步骤4: 连接测试**
1. 输入完配置信息后，点击"测试连接"按钮
2. 系统执行连接测试：
   - 检查IP地址格式
   - 测试网络可达性
   - 尝试建立TCP连接
   - 发送测试指令
3. 测试结果显示：
   - **成功**: 显示"连接测试成功" 🟢
   - **失败**: 显示具体错误信息 🔴

**步骤5: 保存配置**
1. 连接测试成功后，点击"保存配置"按钮
2. 系统弹出确认对话框
3. 确认后系统：
   - 保存新配置到数据库
   - 备份旧配置
   - 更新全局PLC配置
   - 重启PLC通信服务
4. 显示"配置保存成功"提示

#### 7.2 配置说明

**IP地址格式要求**:
- 必须是有效的IPv4地址格式
- 建议使用局域网IP地址
- 确保IP地址在网络中可达

**端口号说明**:
- Modbus TCP默认端口：502
- 可根据PLC实际配置修改
- 范围：1-65535

**超时时间**:
- 建议设置5-10秒
- 网络较差时可适当增加
- 过短可能导致通信失败
- 过长影响用户体验

#### 7.3 故障排除

**连接测试失败的常见原因**:

1. **IP地址错误**
   - 检查IP地址格式是否正确
   - 确认PLC的实际IP地址
   - 使用ping命令测试网络连通性

2. **端口配置错误**
   - 确认PLC的通信端口设置
   - 检查防火墙是否阻止端口

3. **网络连接问题**
   - 检查手机WiFi连接状态
   - 确认手机与PLC在同一网络
   - 检查网络设备（路由器、交换机）状态

4. **PLC设备问题**
   - 检查PLC电源状态
   - 确认PLC通信模块正常
   - 检查PLC的网络配置

### 8. 系统设置和维护

#### 8.1 密码修改
1. 在主界面点击用户名
2. 选择"修改密码"
3. 输入当前密码和新密码
4. 确认新密码后保存

#### 8.2 数据同步
1. 系统会自动同步PLC数据
2. 如需手动同步，在设置中选择"数据同步"
3. 等待同步完成提示

#### 8.3 日志查看
1. 在设置中选择"操作日志"
2. 可查看最近的操作记录
3. 支持按时间和操作类型筛选

## 第二部分：后台Web管理系统操作指南

### 1. 系统登录

#### 1.1 访问系统
1. 打开浏览器，输入系统地址：http://服务器IP:端口/admin
2. 进入登录界面

#### 1.2 管理员登录
1. **用户名**: 输入管理员用户名（默认：admin）
2. **密码**: 输入管理员密码（默认：123456）
3. **验证码**: 输入图形验证码
4. 点击"登录"按钮

#### 1.3 登录后界面
登录成功后进入管理后台主界面：
```
┌─────────────────────────────────────────┐
│ 移动端派工系统 - 管理后台               │
├─────────────────────────────────────────┤
│ 首页 | 角色管理 | 生产记录查询 | 报表管理 │
├─────────────────────────────────────────┤
│                                         │
│  ┌─── 系统概览 ───┐  ┌─── 今日统计 ───┐ │
│  │ 总用户数: 15   │  │ 派工单数: 28   │ │
│  │ 总设备数: 48   │  │ 完成数量: 15420│ │
│  │ 在线用户: 8    │  │ 设备利用率: 85%│ │
│  └───────────────┘  └───────────────┘ │
│                                         │
└─────────────────────────────────────────┘
```

### 2. 角色管理

#### 2.1 用户列表管理

**进入用户管理**
1. 点击顶部导航栏的"角色管理"
2. 进入用户列表界面

**用户列表界面**
```
┌─────────────────────────────────────────────────────────┐
│ 用户管理                                    [+ 新增用户] │
├─────────────────────────────────────────────────────────┤
│ 搜索: [_____________] [搜索] [重置]                      │
├─────────────────────────────────────────────────────────┤
│ ID │ 用户名 │ 姓名   │ 角色     │ 状态 │ 创建时间 │ 操作 │
├─────────────────────────────────────────────────────────┤
│ 1  │ admin  │ 管理员 │ 超级管理员│ 启用 │ 2024-01-01│ 编辑 │
│ 2  │ user01 │ 张三   │ 操作员   │ 启用 │ 2024-01-10│ 编辑 │
│ 3  │ user02 │ 李四   │ 维修员   │ 禁用 │ 2024-01-12│ 编辑 │
└─────────────────────────────────────────────────────────┘
```

#### 2.2 新增用户

**操作步骤**
1. 点击"新增用户"按钮
2. 填写用户信息表单：
   ```
   ┌─── 新增用户 ───┐
   │ 用户名: [________] │
   │ 密码:   [________] │
   │ 确认密码:[______] │
   │ 姓名:   [________] │
   │ 手机号: [________] │
   │ 邮箱:   [________] │
   │ 角色:   [下拉选择] │
   │ 状态:   [启用/禁用]│
   │ 备注:   [________] │
   │                   │
   │ [保存] [取消]     │
   └─────────────────┘
   ```
3. 填写完成后点击"保存"按钮
4. 系统验证信息并创建用户

**字段说明**
- **用户名**: 登录用户名，必须唯一
- **密码**: 登录密码，建议8位以上
- **姓名**: 用户真实姓名
- **手机号**: 联系电话
- **邮箱**: 电子邮箱地址
- **角色**: 选择用户角色（超级管理员/管理员/操作员/维修员）
- **状态**: 账户状态（启用/禁用）

#### 2.3 编辑用户

1. 在用户列表中点击"编辑"按钮
2. 修改用户信息（用户名不可修改）
3. 点击"保存"完成修改

#### 2.4 用户权限管理

**角色权限说明**

| 角色 | 手机端权限 | 后台权限 |
|------|------------|----------|
| 超级管理员 | 全部功能 | 全部功能 |
| 管理员 | 全部功能 | 除用户管理外的全部功能 |
| 操作员 | 派工、停止生产、状态查询 | 生产记录查询 |
| 维修员 | 设备报修、状态查询 | 维修记录查询 |

**权限配置**
1. 编辑用户时可修改用户角色
2. 不同角色对应不同的功能权限
3. 权限变更立即生效

### 3. 生产记录查询

#### 3.1 查询界面

**进入查询界面**
1. 点击顶部导航栏的"生产记录查询"
2. 进入查询条件设置界面

**查询条件设置**
```
┌─── 查询条件 ───────────────────────────────────┐
│ 时间范围: [2024-01-01] 至 [2024-01-31]        │
│ 派工单号: [_______________] (支持模糊查询)     │
│ 设备编号: [全部设备 ▼]                        │
│ 设备类型: [全部类型 ▼]                        │
│ 生产状态: [全部状态 ▼]                        │
│ 操作员:   [全部用户 ▼]                        │
│                                               │
│ [查询] [重置] [导出Excel]                     │
└─────────────────────────────────────────────┘
```

#### 3.2 查询结果展示

**查询结果列表**
```
┌─────────────────────────────────────────────────────────────────────────────┐
│ 生产记录查询结果                                              共找到 156 条记录 │
├─────────────────────────────────────────────────────────────────────────────┤
│派工单号│设备编号│预计数量│实际数量│开始时间│结束时间│耗时│效率│状态│操作员│操作│
├─────────────────────────────────────────────────────────────────────────────┤
│WO240115001│CNC01│1000│950│01-15 09:00│01-15 14:30│5.5h│173│完成│张三│详情│
│WO240115002│CCM08-01│2000│2000│01-15 10:00│01-15 18:00│8h│250│完成│李四│详情│
│WO240115003│AOI-01│500│480│01-15 11:00│进行中│2h│240│运行│王五│详情│
└─────────────────────────────────────────────────────────────────────────────┘
```

#### 3.3 详细信息查看

**查看生产详情**
1. 点击查询结果中的"详情"按钮
2. 弹出生产记录详情窗口：
   ```
   ┌─── 生产记录详情 ───┐
   │ 派工单号: WO240115001 │
   │ 设备信息: CNC01       │
   │ 设备类型: CNC         │
   │ 预计数量: 1000        │
   │ 实际数量: 950         │
   │ 完成率: 95%           │
   │ 开始时间: 2024-01-15 09:00 │
   │ 结束时间: 2024-01-15 14:30 │
   │ 生产耗时: 5小时30分钟  │
   │ 生产效率: 173件/小时   │
   │ 操作员: 张三          │
   │ 备注: 正常完成        │
   │                       │
   │ [关闭]                │
   └─────────────────────┘
   ```

#### 3.4 数据导出

**导出Excel报表**
1. 设置查询条件
2. 点击"导出Excel"按钮
3. 选择导出字段和格式
4. 下载生成的Excel文件

**导出内容包括**
- 派工单基本信息
- 设备信息
- 生产数据统计
- 时间和效率分析
- 操作员信息

### 4. 报表管理

#### 4.1 月度生产报表

**生成月度报表**
1. 点击顶部导航栏的"报表管理"
2. 选择"月度生产报表"
3. 设置报表参数：
   ```
   ┌─── 月度生产报表 ───┐
   │ 统计月份: [2024年1月▼] │
   │ 设备范围: [全部设备▼]   │
   │ 统计维度: [按设备统计▼] │
   │ 报表格式: [图表+表格▼]  │
   │                        │
   │ [生成报表] [导出PDF]   │
   └──────────────────────┘
   ```

**报表内容展示**
```
┌─── 2024年1月生产统计报表 ───┐
│                             │
│ 📊 生产数量统计图表          │
│ ████████████████████████    │
│                             │
│ 📈 设备效率趋势图            │
│ ████████████████████████    │
│                             │
│ 📋 详细数据表格              │
│ ┌─────────────────────────┐ │
│ │设备│派工次数│完成数量│效率│ │
│ ├─────────────────────────┤ │
│ │CNC01│ 25 │ 24500 │ 245 │ │
│ │CNC02│ 23 │ 22800 │ 248 │ │
│ │...  │... │ ...   │ ... │ │
│ └─────────────────────────┘ │
└─────────────────────────────┘
```

#### 4.2 设备效率分析

**效率分析报表**
1. 选择"设备效率分析"
2. 设置分析参数：
   - 分析时间段
   - 对比设备
   - 分析指标
3. 生成效率分析图表

**分析内容包括**
- 设备利用率排名
- 生产效率对比
- 故障率统计
- 维修频次分析
- 改进建议

#### 4.3 自定义报表

**创建自定义报表**
1. 选择"自定义报表"
2. 设置报表参数：
   - 数据源选择
   - 统计字段
   - 分组条件
   - 排序方式
   - 图表类型
3. 预览报表效果
4. 保存报表模板

#### 4.4 报表导出和分享

**导出功能**
- **PDF格式**: 适合打印和存档
- **Excel格式**: 便于数据分析
- **图片格式**: 便于分享和展示

**定时报表**
1. 设置定时生成规则
2. 配置邮件发送列表
3. 系统自动生成并发送报表

## 第三部分：系统维护和故障处理

### 1. 日常维护

#### 1.1 数据备份
1. **自动备份**: 系统每日凌晨自动备份数据库
2. **手动备份**: 在系统设置中可手动触发备份
3. **备份验证**: 定期验证备份文件的完整性

#### 1.2 日志管理
1. **操作日志**: 记录所有用户操作
2. **系统日志**: 记录系统运行状态
3. **错误日志**: 记录系统异常和错误
4. **日志清理**: 定期清理过期日志文件

#### 1.3 性能监控
1. **系统性能**: 监控CPU、内存、磁盘使用情况
2. **数据库性能**: 监控数据库连接数、查询性能
3. **网络状态**: 监控PLC通信状态
4. **用户活跃度**: 统计用户使用情况

### 2. 常见故障处理

#### 2.1 登录问题

**问题**: 无法登录系统
**可能原因**:
- 用户名或密码错误
- 账户被禁用
- 网络连接问题
- 服务器故障

**解决步骤**:
1. 确认用户名和密码正确
2. 检查账户状态是否正常
3. 测试网络连接
4. 检查服务器运行状态
5. 查看系统日志

#### 2.2 PLC通信问题

**问题**: PLC通信失败
**可能原因**:
- PLC IP配置错误
- 网络连接异常
- PLC设备故障
- 防火墙阻止

**解决步骤**:
1. 检查PLC IP配置
2. 测试网络连通性（ping命令）
3. 检查PLC设备状态
4. 确认防火墙设置
5. 重启PLC通信服务

#### 2.3 数据同步问题

**问题**: 数据不同步或丢失
**可能原因**:
- 数据库连接异常
- 同步服务故障
- 数据冲突
- 存储空间不足

**解决步骤**:
1. 检查数据库连接状态
2. 重启数据同步服务
3. 检查数据一致性
4. 清理存储空间
5. 从备份恢复数据

#### 2.4 性能问题

**问题**: 系统响应缓慢
**可能原因**:
- 数据库查询慢
- 服务器资源不足
- 网络带宽限制
- 并发用户过多

**解决步骤**:
1. 优化数据库查询
2. 增加服务器资源
3. 优化网络配置
4. 实施负载均衡
5. 清理系统缓存

### 3. 应急处理

#### 3.1 系统故障应急预案

**故障等级定义**:
- **一级故障**: 系统完全不可用
- **二级故障**: 核心功能不可用
- **三级故障**: 部分功能异常
- **四级故障**: 性能问题

**应急响应流程**:
1. **故障发现**: 监控系统自动报警或用户反馈
2. **故障确认**: 技术人员确认故障等级和影响范围
3. **应急处理**: 根据故障等级执行相应处理措施
4. **故障恢复**: 修复故障并验证系统功能
5. **总结改进**: 分析故障原因并制定改进措施

#### 3.2 数据恢复

**数据丢失处理**:
1. **立即停止**: 停止所有可能影响数据的操作
2. **评估损失**: 确定数据丢失的范围和影响
3. **选择恢复方案**: 根据备份情况选择恢复策略
4. **执行恢复**: 从最近的备份恢复数据
5. **验证数据**: 确认恢复数据的完整性和准确性

#### 3.3 安全事件处理

**安全事件类型**:
- 未授权访问
- 数据泄露
- 恶意攻击
- 系统入侵

**处理步骤**:
1. **隔离系统**: 立即隔离受影响的系统
2. **保护现场**: 保护日志和证据
3. **评估影响**: 确定安全事件的影响范围
4. **修复漏洞**: 修复安全漏洞
5. **恢复服务**: 在确保安全的前提下恢复服务

## 第四部分：最佳实践和建议

### 1. 操作建议

#### 1.1 派工操作建议
1. **派工单号规范**: 建议使用统一的编号规则，如：WO+日期+序号
2. **设备选择**: 优先选择利用率较低的设备，平衡设备负载
3. **数量设置**: 预计生产数量应基于历史数据和设备能力合理设置
4. **及时确认**: PLC通信验证失败时，应及时检查设备状态

#### 1.2 生产管理建议
1. **实时监控**: 定期查看设备状态，及时发现异常
2. **及时停止**: 生产完成后应及时停止，避免数据统计错误
3. **数据准确**: 停止生产时确认实际产量的准确性
4. **异常处理**: 遇到设备异常应先报修再停止生产

#### 1.3 维修管理建议
1. **及时报修**: 发现设备异常应立即报修，避免故障扩大
2. **详细描述**: 故障描述要详细准确，便于维修人员快速定位
3. **优先级设置**: 根据实际影响程度合理设置维修优先级
4. **跟踪进度**: 定期跟踪维修进度，确保及时完成

### 2. 安全建议

#### 2.1 账户安全
1. **密码策略**: 使用强密码，定期更换
2. **权限控制**: 按需分配权限，定期审查
3. **登录监控**: 监控异常登录行为
4. **会话管理**: 设置合理的会话超时时间

#### 2.2 数据安全
1. **定期备份**: 确保数据定期备份
2. **访问控制**: 限制敏感数据的访问权限
3. **传输加密**: 使用HTTPS加密数据传输
4. **审计日志**: 记录所有数据操作日志

#### 2.3 网络安全
1. **防火墙配置**: 正确配置防火墙规则
2. **网络隔离**: 将生产网络与办公网络隔离
3. **入侵检测**: 部署入侵检测系统
4. **定期更新**: 及时更新系统和安全补丁

### 3. 性能优化建议

#### 3.1 系统性能
1. **定期清理**: 清理临时文件和日志
2. **数据库优化**: 定期优化数据库性能
3. **缓存策略**: 合理使用缓存提高响应速度
4. **负载均衡**: 高并发时考虑负载均衡

#### 3.2 用户体验
1. **界面优化**: 保持界面简洁易用
2. **响应速度**: 优化系统响应时间
3. **错误提示**: 提供友好的错误提示信息
4. **操作反馈**: 及时给用户操作反馈

### 4. 培训建议

#### 4.1 用户培训
1. **基础培训**: 新用户必须接受基础操作培训
2. **定期培训**: 定期组织系统使用培训
3. **操作规范**: 制定并培训操作规范
4. **安全意识**: 加强用户安全意识培训

#### 4.2 管理员培训
1. **系统管理**: 培训系统管理和维护技能
2. **故障处理**: 培训常见故障的处理方法
3. **安全管理**: 培训系统安全管理知识
4. **应急处理**: 培训应急事件处理流程

## 附录

### 附录A：系统配置参数

| 参数名称 | 默认值 | 说明 |
|----------|--------|------|
| PLC_IP | 192.168.1.100 | PLC设备IP地址 |
| PLC_PORT | 502 | PLC通信端口 |
| CONNECTION_TIMEOUT | 5000 | 连接超时时间(毫秒) |
| RETRY_COUNT | 3 | 通信重试次数 |
| SESSION_TIMEOUT | 30 | 会话超时时间(分钟) |
| BACKUP_INTERVAL | 24 | 备份间隔时间(小时) |
| LOG_RETENTION | 30 | 日志保留天数 |

### 附录B：错误代码对照表

| 错误代码 | 错误描述 | 解决方案 |
|----------|----------|----------|
| E001 | 用户名或密码错误 | 检查登录凭据 |
| E002 | 账户已被禁用 | 联系管理员 |
| E003 | PLC通信失败 | 检查网络和PLC状态 |
| E004 | 设备正在维修中 | 选择其他设备 |
| E005 | 派工单号重复 | 使用新的派工单号 |
| E006 | 数据保存失败 | 检查网络连接 |
| E007 | 权限不足 | 联系管理员分配权限 |
| E008 | 系统维护中 | 等待维护完成 |

### 附录C：联系方式

**技术支持**:
- 电话：400-xxx-xxxx
- 邮箱：support@company.com
- QQ群：xxxxxxxxx

**紧急联系**:
- 24小时热线：138-xxxx-xxxx
- 紧急邮箱：emergency@company.com

**系统管理员**:
- 姓名：张工程师
- 电话：139-xxxx-xxxx
- 邮箱：admin@company.com

---

**文档版本**: v1.0  
**最后更新**: 2024年1月15日  
**编写人员**: 系统开发团队  
**审核人员**: 技术经理